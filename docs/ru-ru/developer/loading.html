---
layout: ru-ru/default
title: "Загрузка файлов - Документация OpenCart"
permalink: ru-ru/developer/loading/
---
<h1>Загрузка файлов в контроллер</h1>
<p>В платформе MVC-L OpenCart контроллер Вашего модуля является связующим звеном, соединяющим файлы Вашего языка, модели и шаблона друг с другом. Контроллер отвечает за захват текста, содержащегося в языковом файле, и обеспечение его доступности в качестве переменных PHP в файле шаблона представления. Помимо наследования функций, доступных в родительском классе контроллера, Controller, вы также можете загрузить любой из файлов модели OpenCart по умолчанию и их функции в контроллер. В этой документации мы покажем код PHP, необходимый для загрузки файлов языка и модели и их функций.</p>
<h2>Загрузка языкового файла</h2>
<p>Контроллер выводит текст, сохраненный в языковом файле, и превращает их в переменные, которые можно отобразить в файле шаблона, в отображаемый текст. Это особенно полезно для управления переводами Вашего модуля. Вместо того, чтобы изменять Ваш файл .tpl (.twig) каждый раз, когда у Вас есть новый перевод для изменения каждого фрагмента текста внутри, Вам просто нужно изменить текст в Вашем языковом файле, и переменные в контроллере и шаблоне останутся такими же.</p>
<p>Кусок кода ниже загрузит языковой файл внутри контроллера Вашего модуля. В скобках необходимо указать путь к языковому файлу из языковой папки.</p>
<div class="code"><code>$this-&gt;load-&gt;language(&#39;module/my_module&#39;);</code></div>
<p>Важно помнить, что контроллер администратора будет загружать только языковой файл администратора, но не языковой файл каталога; и аналогично контроллер каталога будет загружать только языковой файл каталога. Как только языковой файл загружен в контроллер, вы можете сохранить его текст в переменной php с помощью массива $data. $this-&gt;language-&gt;get(&#39;text&#39;) возьмет текст из $_[&#39;text&#39;] переменной внутри языкового файла.</p>
<div class="code"><code>$this-&gt;data[&#39;text&#39;] = $this-&gt;language-&gt;get(&#39;text&#39;);</code></div>
<p>$this-&gt;language-&gt;get(&#39;text&#39;) возьмет текст из $_[&#39;text&#39;] переменная внутри языкового файла, который мы только что загрузили. Каждый элемент массива данных будет преобразован в свою переменную. $data[&#39;text&#39;] станет $text для файла шаблона изнутри. Переменная $text может быть отражена в файле view&#39;s .tpl где нужно:</p>
<div class="code"><code>&lt;p&gt;&lt;?php echo $text; ?&gt;&lt;/p&gt;</code></div>
<h3>Установка заголовка тайтла</h3>
<p>Следующий код установит текст из языкового файла в качестве заголовка страницы:</p>
<div class="code"><code>$this-&gt;document-&gt;setTitle($this-&gt;language-&gt;get(&#39;heading_title&#39;));</code></div>
<p>Это получит текст для переменной $_[&#39;heading_title&#39;] хранится в модуле языкового файла.</p>
<div class="alert alert-success" role="alert"><i class="fa fa-check-circle"></i> Если Вам нужно сохранить текст как переменную сеанса php, используйте $this-&gt;session-&gt;data[&#39;text&#39;] вместо того $this-&gt;data[&#39;text&#39;].</div>
<h2>Загрузка файлов моделей</h2>
<p>Загрузка файлов модели в файл Вашего контроллера позволит Вашему модулю использовать встроенные функции OpenCart. Функции внутри файлов модели взаимодействуют с базой данных магазина и добавляют/извлекают важную информацию для Вашего модуля. Мы рекомендуем Вам воспользоваться этими функциями, а не делать собственные запросы к БД. Потратьте некоторое время на изучение папок модели в файлах администратора и каталога, чтобы увидеть, какие файлы могут принести пользу Вашему модулю. Например, если Вашему модулю нужно извлечь информацию о продукте из базы данных магазина, будет полезно загрузить файл admin/model/catalog/products.php, так как он уже имеет множество полезных встроенных функций, которые взаимодействуют с товары магазина в базе.</p>
<p>Ваш модуль может загрузить любой файл модели в свой файл контроллера, используя следующий код, при условии, что они находятся в той же папке администратора или каталога, что и контроллер.</p>
<div class="code"><code>$this-&gt;load-&gt;model(&#39;setting/setting&#39;);</code></div>
<p>Вам нужно будет указать путь к файлу, который Вы хотите загрузить из папки администратора в скобках. Приведенный выше код загрузит класс настроек, поэтому у нас есть доступ к функциям внутри класса ModelSettingSetting в файле контроллера нашей модели. Используйте следующий формат в Вашем коде для вызова функции из загруженного файла модели:</p>
<div class="code"><code>$this-&gt;model_setting_setting-&gt;editSetting(&#39;my_module&#39;, $this-&gt;request-&gt;post);</code></div>
<p>Подчеркивания относятся к обозначениям файлов для модели/setting/setting.php. Если у Вас есть файл модели для Вашего модуля, Ваш код будет соответствовать указанному выше формату, так как файл модели загружается в папку модели.</p>
<div class="code"><code>$this-&gt;load-&gt;model(module/my_module.php);<br />
  $this-&gt;model_module_my_module-&gt;myFunction();</code></div>
<p>Приведенный выше код загрузит файл my_module.php, хранящийся в admin/model/module/my_module.php.</p>
<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> Вместо использования пробелов в именах файлов для Вашего модуля используйте подчеркивание.</div>
<h2>Загрузка файлов шаблона</h2>
<p>В контроллере Вам нужно будет загрузить файл шаблона Вашего модуля в поле зрения. Для этого установите $this-&gt;template как так:</p>
<div class="code"><code>$this-&gt;template = &#39;module/my_module.tpl&#39;;</code></div>
<h2>Загрузка файлов библиотеки</h2>
<p>Каталог OpenCart содержит коллекцию файлов библиотеки, к которым могут обращаться файлы как администратора, так и контроллера каталога. Эти файлы находятся в папке system/library в корневой папке магазина OpenCart. В примерах кода видно загрузку языкового файла, оба $this-&gt;load-&gt;language и $this-&gt;document предоставить доступ к функциям в файлах language.php и document.php в папке библиотеки. Если Вы хотите получить доступ к функции из файла библиотеки, Вам нужно вызвать ее с помощью $this-&gt;[insert library file name]-&gt;function() в классе контроллера.</p>
<h2>Дополнительная информация</h2>
<p>Для получения дополнительной информации о концепции поведения контроллера в рамках MVC или в контексте разработки модуля для OpenCart см. <a href="ru-ru/developer/loading/">Вступление</a> и <a href="ru-ru/developer/module/">Разработка модулей</a>. Чтобы увидеть, как загруженные файлы могут быть использованы в базовом модуле, см. DIY-модуль из <a href="http://opencart.hostjars.com/">HostJars</a></p>
