---
layout: ru-ru/default
title: "Разработка модулей - Документация OpenCart"
permalink: ru-ru/developer/module/
---
<h1>Разработка модулей</h1>
<p>Написание модулей OpenCart может быть очень хорошим способом узнать, как <a href="ru-ru/developer/loading/">основы OpenCart</a> действительно работают. Как и остальные компоненты OpenCart, модули следуют шаблону проектирования MVCL. В этом руководстве по документации будет описано, как Dы используете каждый из компонентов MVC-L для создания <a href="ru-ru/administration/">админки</a> и <a href="ru-ru/store-front/">витрины</a> части Вашего модуля. Самый простой способ создать модуль - это загрузить <a href="http://opencart.hostjars.com/creating-opencart-modules">DIY Module Builder</a> скелет из <a href="http://opencart.hostjars.com/">HostJars</a>. Этот модуль содержит структуру каталогов, файлы и инструкции о том, как понимать и создавать свои собственные модули. Эта страница является более теоретическим руководством.</p>
<h2>Основная структура каталогов</h2>
<p>Базовая файловая структура Вашего модуля будет разделена на две части: папку администратора и каталог. Содержимое каждой папки будет соответствовать структуре MVC-L соответственно, с той разницей, что администратор будет заниматься исключительно функциональностью бэкэнда, а каталог - функциональностью веб-интерфейса. Пользователи Вашего модуля будут взаимодействовать и настраивать его параметры в административной части магазина. Следовательно, файлы в папке администратора будут обрабатывать любые изменения в его настройках, способ отображения модуля в администрировании, установку/удаление модуля и т.д. Аналогичным образом, способ отображения модуля и его работа в интерфейсе пользователя. из магазина будут обрабатываться файлы в папке каталога.</p>
<p class="text-center"><img src="image/file_struct.png" alt="file struct" class="img-thumbnail" /></p>
<p>На изображении выше показан скелет структуры каталогов, которой должен следовать Ваш модуль. Хороший способ начать работу с Вашим модулем - продублировать структуру папок и создать указанные выше файлы. То, что будет в этих файлах, определяется тем, что Ваш модуль пытается выполнить, но основные функции подробно описаны в разделах ниже.</p>
<h2>Функциональность модуля администратора</h2>
<p>Когда владелец магазина использует Ваш модуль, он захочет отредактировать параметры конфигурации модуля в администраторе, чтобы решить, на каких макетах будет отображаться модуль, включен ли он или отключен, и какие-либо специфичные для модуля параметры. Как разработчику модуля, вам нужно будет создать страницу администратора, на которой можно редактировать модуль и добавлять или настраивать параметры конфигурации.</p>
<p>Все файлы администратора находятся в папке admin/. Вы найдете четыре папки в папке admin/:</p>
<ol>
  <li>controller</li>
  <li>view</li>
  <li>language</li>
  <li>model</li>
</ol>
<p>Для всех модулей потребуется по крайней мере один файл в каждой из папок вида и контроллера. Большинству потребуется файл в каждой из папок модели и языка. Обычно файлы имеют одинаковое имя, за исключением того, что файл представления имеет другой суффикс (.tpl или .twig). Мы пройдемся по этим файлам один за другим.</p>
<p class="text-center"><img src="image/mvcl.png" alt="mvcl" class="img-thumbnail" /></p>
<h3>Контроллер</h3>
<p>Первый файл, который Вы создадите, будет контроллером страницы интерфейса Вашего модуля. OpenCart автоматически идентифицирует существующие модули, просто прочитав папку admin/controller/module Вашего магазина. Любые модули, существующие в этой папке, будут автоматически показаны на странице <a href="ru-ru/extension/module/">Модулей</a>, и на странице <a href="ru-ru/system/user/">Пользовательские разрешения</a>. Вы можете вызвать файл Вашего контроллера my_module.php.</p>
<p>Файл контроллера - это место, где Вы можете загрузить языковые файлы для преобразования текста в переменные, которые будут использоваться в файле шаблона. На диаграмме выше Вы можете увидеть $_[&#39;text&#39;] переменная обрабатывается контроллером, а затем отправляется в виде $text в представление. Здесь Вы также будете использовать несколько файлов моделей и их функций класса, включая файл модели вашего модуля, если он есть. Для получения дополнительной информации о загрузке файлов см. <a href="ru-ru/developer/loading/">Загрузка файлов в контроллер</a>.</p>
<p>Вы также можете иметь функцию, определенную как public function install (). Эта функция будет срабатывать при нажатии на ссылку установки на странице <a href="ru-ru/extension/module/">Расширения &gt; Модули</a>. Аналогично, функция, определенная как public function uninstall (), будет запущена при нажатии на ссылку удаления. Вы можете использовать эти функции для создания и удаления любых структур (таких как таблицы базы данных или настройки конфигурации), требуемых Вашим модулем. Хорошей практикой является создание функции удаления для очистки любых изменений, внесенных Вашим модулем. Чтобы увидеть конкретный код для install(), uninstall(), посетите <a href="ru-ru/extension/module/install/">Установить/удалить модуль</a>.</p>
<h4>Доступ через URL</h4>
<p>Контроллер - единственный файл в структуре MVC-L, доступ к которому осуществляется по URL в OpenCart. В администрации URL будет выглядеть так /admin/index.php?route=module/my_module&amp;token. Администратор добавляет токен в URL, тогда как ссылка в каталоге его не будет иметь. В результате файл контроллера будет иметь функцию, определенную как public function index(). Это общедоступный &#39;page&#39; загружается по URL-адресу, который будет показан при <a href="ru-ru/extension/module/edit/">Кнопка редактирования</a> и где форма просмотра будет отправлена. Представленные данные будут обработаны в этой функции и сохранены в таблице базы данных `settings` через объект конфигурации контроллера.</p>
<h3>Представление</h3>
<p>Второй необходимый файл для интерфейса администратора Вашего модуля - это файл вида. Он будет создан в папке admin/view/template/module и будет иметь суффикс .tpl (.twig). Это стандарт для файлов просмотра OpenCart. В этом файле Вы создадите форму для пользователя, чтобы заполнить и отправить. Он будет передан в индексную функцию контроллера модуля. Самый простой способ создать файл представления - это скопировать и вставить существующий аналогичный файл представления и отредактировать форму, чтобы она содержала правильные поля для параметров конфигурации Вашего модуля. Вы можете вызвать в Ваш файл представления my_module.tpl (my_module.twig).</p>
<p>В представлении Вы сможете получить доступ к тексту на языке, который хранится в файле контроллера как переменная PHP. См. Загрузка файлов в Контроллере для получения кода о том, как это сделать.</p>
<h3>Модель</h3>
<p>Модули редко требуют файл модели на стороне администратора. Однако, если Ваш модуль использует собственную таблицу базы данных или пользовательский запрос для создания данных определенного формата, то Вы можете написать файл модели. Примером этого может быть, если вы пишете модуль счетчика посетителей, где каждый посетитель хранится в таблице базы данных со своим IP-адресом и количеством посещений. Затем Вы можете создать файл модели с функцией для определения и создания этой дополнительной таблицы в базе данных OpenCart. Файл модели будет находиться в папке admin/model/module. Вы можете вызвать файл модели my_module.php, такой же, как Ваш контроллер и языковые файлы.</p>
<h2>Функциональность внешнего интерфейса</h2>
<p>Внешний интерфейс Вашего модуля следует той же схеме, что и описанный выше интерфейс администратора. То, что Вы будете включать в каждый из Ваших файлов внешнего интерфейса, будет в значительной степени зависеть от того, что должен делать Ваш модуль. Модуль может обращаться к любым файлам моделей, которые уже существуют в OpenCart, Вам не нужно писать собственные запросы к базе данных, если такой же запрос уже существует. Например, catalog/product модель содержит много полезных запросов для получения продуктов. Использование этих функций модели должно быть предпочтительнее, чем изобретать велосипед.</p>
<p>Ключевое отличие во внешнем интерфейсе Вашего модуля заключается в том, что Ваш файл представления будет находиться в папке catalog/view/theme/(themename)/template/module. Это значительно более глубокая структура папок для файла представления администратора из-за тем. Магазин OpenCart может иметь много разных <a href="https://www.opencart.com/index.php?route=marketplace/extension&filter_category_id=1" target="_blank">темы интерфейса</a> доступен, но только один админ шаблон. (themename)</p>
<p>Во внешней части Вашего модуля Вы будете иметь доступ к опциям конфигурации, сохраненным Вашим модулем, через объект конфигурации контроллера и переменную $settings, передаваемую в функцию индекса контроллера модуля. На основе этих настроек Вы можете управлять аспектами отображения веб-интерфейса.</p>
